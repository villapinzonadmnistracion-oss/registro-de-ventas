<!-- Mensaje Cliente No Encontrado -->
<div class="cliente-no-encontrado" id="clienteNoEncontrado">
  <h3>âš ï¸ Cliente No Encontrado</h3>
  <p>El RUT ingresado no estÃ¡ registrado.</p>
  <a href="https://formulario-clientes-chi.vercel.app/" target="_blank" class="btn-registrar">
    â• Registrar Nuevo Cliente
  </a>
</div>

<!-- Loading Spinner -->
<div class="loading" id="loading">
  <div class="spinner"></div>
  <p>Procesando...</p>
</div>

<!-- AnfitriÃ³n del Turno -->
<div class="section-card sidebar-section" id="anfitrionTurnoContainer">
  <h3>ğŸ‘¤ AnfitriÃ³n del Turno</h3>
  <div class="form-field">
    <select id="anfitrionTurnoSelect" class="form-select" onchange="establecerAnfitrionTurno()">
      <option value="">Seleccionar anfitriÃ³n del turno...</option>
    </select>
    <small class="field-hint" style="color: rgba(9, 9, 9, 0.9); margin-top: 6px;">
      ğŸ’¡ Selecciona una vez al inicio del turno
    </small>
  </div>
  <div id="anfitrionActual" style="display: none; background: rgba(5, 5, 5, 0.25); padding: 10px; border-radius: 8px; margin-top: 8px; text-align: center;">
    <div style="font-size: 0.85em; opacity: 0.9; margin-bottom: 4px;">Trabajando:</div>
    <div style="font-weight: 700; font-size: 1em;" id="nombreAnfitrionActual">-</div>
  </div>
</div>

<!-- Campo de Descuento -->
<div class="section-card sidebar-section">
  <h3>ğŸ’° Descuento</h3>
  <div class="form-field">
    <label>Porcentaje de descuento (%)</label>
    <input
      type="number"
      id="descuento"
      class="form-input"
      placeholder="0"
      min="0"
      max="100"
      value="0"
      oninput="calcularTotal()"
    />
  </div>
</div>

<!-- Resumen -->
<div class="resumen-box sidebar-resumen">
  <h3>Resumen de TransacciÃ³n</h3>
  <div class="resumen-item">
    <span>Subtotal:</span>
    <span id="subtotal">$0</span>
  </div>
  <div class="resumen-item">
    <span>Descuento:</span>
    <span id="montoDescuento">$0</span>
  </div>
  <div class="resumen-item total">
    <span>Total:</span>
    <span id="total">$0</span>
  </div>
</div>

<!-- Botones de AcciÃ³n -->
<div class="action-buttons sidebar-actions">
  <button class="btn btn-primary" onclick="registrarVenta()">
    âœ… Registrar TransacciÃ³n
  </button>
  <button class="btn btn-secondary" onclick="limpiarFormulario()">
    ğŸ”„ Limpiar Formulario
  </button>
</div>

<!-- SecciÃ³n de Productos -->
<div class="section-card">
  <h3>ğŸ›’ Agregar Productos</h3>
  <div class="form-grid">
    <div class="form-field">
      <label>CÃ³digo de Barras</label>
      <input
        type="text"
        id="codigoBarras"
        class="scan-input"
        placeholder="Escanear cÃ³digo de barras..."
        onkeypress="procesarCodigoBarras(event)"
      />
      <small class="field-hint">ğŸ’¡ Presiona Enter despuÃ©s de escanear</small>
    </div>
  </div>

  <div class="table-container">
    <table class="productos-table" id="productosLista">
      <thead>
        <tr>
          <th>Producto</th>
          <th>Precio ($)</th>
          <th>Cantidad</th>
          <th>Subtotal ($)</th>
          <th>AcciÃ³n</th>
        </tr>
      </thead>
      <tbody>
        <!-- Productos agregados dinÃ¡micamente -->
      </tbody>
    </table>
  </div>
</div>

<!-- Devoluciones -->
<div class="section-card devolucion-section" id="devolucionesSection" style="display: none;">
  <h3>ğŸ“¥ Productos en DevoluciÃ³n</h3>

  <div class="form-grid">
    <div class="form-field">
      <label>CÃ³digo de Barras / Producto a Devolver</label>
      <input
        type="text"
        id="codigoDevolucion"
        class="scan-input devolucion-input"
        placeholder="Escanear o escribir cÃ³digo..."
        onkeypress="procesarCodigoDevolucion(event)"
      />
      <small class="field-hint">ğŸ’¡ Presiona Enter despuÃ©s de escanear</small>
    </div>
  </div>

  <div class="table-container">
    <table class="productos-table" id="devolucionesLista">
      <thead>
        <tr>
          <th>Producto</th>
          <th>Precio ($)</th>
          <th>AcciÃ³n</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><input type="text" class="devolucion-nombre" placeholder="Nombre del producto"></td>
          <td><input type="text" class="devolucion-precio" placeholder="0" oninput="formatearPrecio(this); calcularTotal();"></td>
          <td><button class="btn btn-remove" onclick="eliminarProductoDevolucion(this)">ğŸ—‘ï¸</button></td>
        </tr>
      </tbody>
    </table>
  </div>

  <button class="btn btn-add-devolucion" onclick="agregarProductoDevolucion()">
    â• Agregar Producto a DevoluciÃ³n
  </button>
  
  <!-- Campo de AutorizaciÃ³n -->
  <div class="form-field" style="margin-top: 20px;">
    <label for="autorizacionDevolucion">
      ğŸ‘¤ Â¿QuiÃ©n autorizÃ³ esta devoluciÃ³n? <span style="color: #ef4444;">*</span>
    </label>
    <input
      type="text"
      id="autorizacionDevolucion"
      class="form-input"
      placeholder="Nombre de quien autoriza..."
      style="width: 100%; padding: 12px; border: 2px solid #d1d5db; border-radius: 8px; font-size: 14px;"
    />
    <small class="field-hint" style="color: #6b7280; display: block; margin-top: 6px;">
      ğŸ“ Campo obligatorio para registrar la devoluciÃ³n
    </small>
  </div>
</div>

<!-- Notas Adicionales -->
<div class="section-card">
  <h3>ğŸ“ Notas Adicionales (Opcional)</h3>
  <div class="form-field">
    <textarea
      id="notas"
      class="form-textarea"
      placeholder="Escribe cualquier observaciÃ³n o nota adicional..."
    ></textarea>
  </div>
</div>